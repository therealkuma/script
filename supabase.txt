from supabase import create_client
import os

url = "https://mtzsehyiltudrizggrfa.supabase.co"
key = "sb_secret_hc_JEe4MgsjukIJpWwxLZA_K2NR3uCA"

supabase = create_client(url, key)

def insert_user(username, name, email, password):
    return supabase.table("users").insert({
        "username": username,
        "name": name,
        "email": email,
        "password": password
    }).execute()

def get_user(username):
    return supabase.table("users").select("*").eq("username", username).single().execute()

# def fetch_all_users():
#     return supabase.table("users").select("*").execute()

def update_user(username, updates):
    return supabase.table("users").update(updates).eq("username", username).execute()

def delete_user(username):
    return supabase.table("users").delete().eq("username", username).execute()

def fetch_all_users():
    response = supabase.table("users").select("key, name, password").execute()
    return response.data   # âœ… list of dicts
